@model MCQInterviews.Models.ViewModels.BulkQuestionExcelViewModel
@{
}

<div class="container py-2">
    @if (TempData["successMsg"] != null)
    {
        <div class="alert alert-success">
            @TempData["successMsg"]
        </div>
    }

    @if (TempData["errorMsg"] != null)
    {
        <div class="alert alert-danger">
            <i class="fa fa-exclamation-triangle"></i>
            @TempData["errorMsg"]
        </div>
    }
    <div class="card mt-2">
        <div class="card-header">
            <h5 class="text-primary text-primary text-center"> Add Bulk Questions</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-6">
                    <div class="feedback-container mt-3 mb-3">
                        <p><strong class="text-danger">How to create Bulk Questions in Excel for Easy Uploading:</strong></p>
                        <div class="feedback-content">
                            <p class="small">
                                For easy bulk upload of questions:
                                <ol class="small">
                                    <li>Create an Excel sheet.</li>
                                    <li>Leave the first row blank for headers (Question, Option1, Option2, Option3, Option4, Correct Option Index).</li>
                                    <li>In the second row (and subsequent rows), enter your question text in column A. Following columns (B-E) will hold answer options. Finally, in column F, enter the number corresponding to the correct answer (e.g., "3" for the third option).</li>
                                    <li>Save the Excel file.</li>
                                    <li>Select the Job Category from the "Job Category" list down</li>
                                    <li>Select the Job Title from the "Job Title" list down</li>
                                    <li>Select the Difficulty Type from the"Difficulty Type" list down</li>
                                    <li>Upload the Excel file already saved. </li>
                                    <li>Click on the button "Import Excel File".</li>
                                </ol>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-6">
                    <form method="post" enctype="multipart/form-data">
                        <div asp-validation-summary="ModelOnly" class="text-danger" role="alert"></div>

                        <div class="row mb-3">
                            <div class="form-group mb-2 ">
                                @Html.Label("ThemeId", "Category")
                                @Html.DropDownList("ThemeId", (IEnumerable<SelectListItem>)ViewData["Themes"], "Select a Category", new { @class = "form-control", id = "ThemesDropdown", @required = "required" })
                                @Html.ValidationMessage("ThemeId")
                            </div>
                            <div class="form-group mb-2">
                                @Html.Label("JobTitleId", "Job Title")
                                <select id="JobTitlesDropdown" name="JobTitleId" class="form-control" required>
                                    <option value="" selected disabled>Select a Job Title</option>
                                </select>
                                @Html.ValidationMessage("JobTitleId")
                            </div>
                            <div class="form-group mb-2">
                                @Html.Label("DifficultyTypeId", "Difficulty Type")
                                @Html.DropDownList("DifficultyTypeId", (IEnumerable<SelectListItem>)ViewBag.DiffTypes, "Select a Difficulty Type", new { @class = "form-control", @required = "required" })
                                @Html.ValidationMessage("DifficultyTypeId")
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="form-group ">
                                <label for="file">Upload Excel File:</label>
                                <input type="file" name="file" class="form-control" required />
                            </div>
                            <div class="form-group  mt-2">
                                <button type="submit" class="btn btn-primary"> <i class="fas fa-upload"></i> Upload Excel File </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
